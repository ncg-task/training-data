title
Focal Visual-Text Attention for Visual Question Answering
abstract
Recent insights on language and vision with neural networks have been successfully applied to simple singleimage visual question answering. However, to tackle reallife question answering problems on multimedia collections such as personal photos, we have to look at whole collections with sequences of photos or videos. When answering questions from a large collection, a natural problem is to identify snippets to support the answer. In this paper, we describe a novel neural network called Focal Visual-Text Attention network (FVTA) for collective reasoning in visual question answering, where both visual and text sequence information such as images and text metadata are presented. FVTA introduces an end-to-end approach that makes use of a hierarchical process to dynamically determine what media and what time to focus on in the sequential data to answer the question. FVTA cannot only answer the questions well but also provides the justifications which the system results are based upon to get the answers. FVTA achieves state-of-the-art performance on the MemexQA dataset and competitive results on the MovieQA dataset.
Introduction
Language and vision have emerged as a popular research are a in computer vision. Visual question answering (VQA) is a successful direction utilizing both computer vision and natural language processing techniques to solve an interesting problem: given a pair of image and a question (in natural language), the goal is to learn an inference model that can the answer questions according to cues discovered from the image. A variety of methods have been proposed to address the challenges from different aspects, with remarkable progress on answering about a single image.
Extending from VQA on a single image, this paper considers the following problem: Suppose a user's photos and videos are organized in a sequence ordered by their creation time. Some photos or videos maybe associated with meta labels or annotations such as time, GPS, captions, comments, and meaningful title. We are interested in training There are two challenges to solve the above problem. First, the input is provided in an unstructured form. The question is associated with multiple sequences, in the form of videos or images. Such sequences are temporally ordered, and each sequence contains multiple time steps. At each time there are visual data, text annotations and other metadata. In this paper, we call the format visual-text sequence data. Note that not all the photos and videos are annotated, which requires a robust method to leverage inconsistently available multimodal data.
The second challenge requires interpretable justifications in addition to direct answer based on sequence data. To help users with a lot of photos and videos, a natural requirement is to identify the supporting evidence for the answer. An example question as shown in, is "when was the last time I went to a bar?" From the users' viewpoint, a good QA system should not only give a definite answer (e.g., January 20, 2016), but also ground evidential images or text snippets in the input sequence to justify the reasoning process. Given imperfect VQA models, humans often want to verify the answer. The inspection process maybe trivial for a single image but can take a significant amount of time to examine every image and the complete text words.
To address these two challenges, we propose a focal visual-text attention (FVTA) model for sequential data 1 . Our model is motivated by the reasoning process of humans.
In order to answer a question, a human would first quickly skim the input and then focus on a few, small temporal regions in the visual-text sequences to derive an answer. In fact, statistics suggest that, on average, humans only need 1.5 images to answer a question after the skimming. Inspired by this process, FVTA first learns to localize relevant information within a few, small, temporally consecutive regions over the input sequences, and learns to infer an answer based on the cross-modal statistics pooled from these regions. FVTA proposes a novel kernel to compute the attention tensor that jointly models the latent information in three sources: 1) answer-signaling words in the question, 2) temporal correlation within a sequence, and 3) cross-modal interaction between the text and image. FVTA attention allows for collective reasoning by the attention kernel learned over a few, small, consecutive sub-sequences of text and image. It can also produce a list of evidential images/texts to justify the reasoning. As shown in, the highlighted cubes are regions of high activations in the proposed FVTA. To summarize, the contribution of this paper is threefold:
? We propose a novel attention kernel for VQA on visual-text data. Experiments show that it outperforms existing attention methods.
? The proposed attention tensor can be used to localize evidential image and text snippets to explain the reasoning process. We quantitatively verify that the evidence produced by our method are more correlated to that of human annotators.
? Our method achieves the state-of-the-art results on two VQA benchmarks.

Related Work
Visual Question Answering. Image-based visual question answering has received a large amount of interest in the computer vision community. A lot of efforts have been conducted on single image QA datasets, where a common practice is to train a classifier by combining both question feature and visual features. A recent direction is on the question answering based on videos, which is more relevant to this work. A number of research studies have been carried on MovieQA, with movie clips, scripts, and descriptions. Because it is expensive to annotate the video-based QA datasets, some research studies generate QA datasets by harvesting online videos and descriptions, while a recent study considers question answering using animated GIFs. This work differs from the existing video-based QA in two aspects: video-based QA is to answer questions based on a single video, while our work can handle general visual-text sequences, where one user may have more than one video or albums of photos. (2) most existing video-based QA methods map one video sequence with text into a context feature vector, while our work explores a more fine-grained model by modeling the correlation between query and sequence data at every time step. To this end, we experiment on the MemexQA dataset. The sequential data in MemexQA involves multiple modalities, including titles, timestamps, GPS and visual content, render it an ideal test bed for QA research over visual-text sequence data. Unlike the model in, our method also uses the text embedding of the answer choices as the input to answer a question.
Attention Mechanism. This work can be viewed as a novel attention model for multiple variable-length sequential inputs, to take into account not only the visual-text information but also the temporal dependency. Our work extends the previous studies of using attention model for Image QA. A key difference between our method and classical attention model lies in the fact we are modeling the correlation at every time step, across multiple sequences. Existing attention mechanisms for VQA mainly focus on attention within spatial regions of an image or within a single sequence, and hence, may not fully exploit the multiple sequences and multiple time steps nature. As shows, our attention is applied to a three-dimensional tensor, while the classic soft attention model is applied to a vector or matrix.

Approach

Problem Formulation
We start the discussion by formally defining the problem. Let Q = q 1 , ? ? ? , q M represent a question of M words Q ? Z M , where each word is an integer index in the vocabulary. Define a context visual-text sequence of T examples X = x 1 , ? ? ? , x T , where for each example, x img t represents an image. x txt t is its corresponding text sentence, where its i-th word is indexed by x txt ti . Following, the answer to a question is an integer y ? [1, L] over the answer vocabulary of size L. Given a collection of n questions and their context sequences, we are interested in learning a model maximizing the following likelihood:
where ? represents the model parameters. Given the visualtext sequence input X img , X txt , we obtain a good joint representation by attention model. With FVTA attention, the model takes into account of the sequential dependency in image or text sequence, respectively, and cross-modal visual-text correlations. Meanwhile, the computed attention weights over input sequences can be utilized to derive meaningful justifications.

Network Architecture
This subsection discusses our over all neural network architecture. As shown in, the proposed network consists of the following layers. Visual-Text Embedding Every image or video frame is encoded with a pre-trained Convolutional Neural Network. Both word-level and character level embedding are used to represent the word in text and question. Sequence Encoder We use separate LSTM networks to encode visual and text sequences, respectively, to capture the temporal dependency within each individual sequence. The inputs to the LSTM units are image/text embedding produced by the previous layer. Let d denote the size of the hidden state of the LSTM unit; the question Q is represented as a matrix Q of concatenated bi-directional LSTM outputs at each step, i.e., Q ? R 2d?M , where M is the maximum length of the question. Likewise, The sequentially encoded text and images are represented by H ? R 2d?T ?2 , where T is the maximum length of the sequence. Focal Visual-Text Attention The FVTA is a novel layer to implement the proposed attention mechanism. It represents a network layer that models the correlations between questions and multi-dimensional context and produces the summarized input to the final output layer, i.e.,h ? R 2d andq ? R 2d . We will discuss FVTA in the next section. Output Layer After summarizing the input using the FVTA attention, we use a feed-forward layer to obtain the answer candidate. For multiple-choices questions, the task is to se-lect one answer from a few candidate choices given the context and the question. Let k denote the number of candidate answers, we utilize the bi-directional LSTM to encode each of the answer choice and use the last hidden state as the representation for answers E ? R k?2d . We tile the context representationh and attended question representation, k times intoH ? R k?2d andQ ? R k?2d to compute the classification probability of k choices. In practice we find the following simple equation works better than fully connected layer or straightforward concatenation:
where the operator [?; ?] represents the concatenation of two matrices along the last dimension.
is the element-wise multiplication, w p is the weight vector to learn and p is a vector of classification probability. After obtaining the answer probability, the model can be trained end-to-end using cross-entropy loss function.

Focal Visual-Text Attention
This section discusses the details of FVTA model as the key module in our VQA system. We first introduce similarity metric between visual and text features, then discuss constructing the attention tensor that captures both intrasequence dependency and inter-sequence interaction.

Similarity between visual and text features
To compute the similarity across different modalities, i.e. visual and text, we first encode every modality by the LSTM networks with the same size of hidden states. Then we measure the differences between these hidden state variables. Following the study in text sequence matching, we aggregate both the cosine similarity and Euclidean distance to compare the features. Moreover, we choose to keep the vector information instead of summing up after the operation. The vector representation can be used as the input of a learning model, whose inner product represents the similarity between these features. More specifically, we use the following equation to compute the similarity representation between two hidden state vectors v 1 and v 2 . The result is a vector of twice the hidden size:

Intra-sequence temporal dependency
Our visual-text attention layer is designed to let the model select related visual-text region or timestep based on each word of the question. Such fine-grained attention is in general nontrivial to learn. Meanwhile, most answers for visual-text sequence inputs maybe constrained and restricted in a short temporal period. We learn such localized representation, called focal context representation, to emphasize relevant context states based on the question.
First, we introduce a temporal correlation matrix, C ? R T ?T , asymmetric matrix where each entry c ij measures the correlation between context's the i-th step and the j-th step for a question. Let hi = H :i: ? R 2d?2 denote the visual/text representation for the i-th timestep in H. For notation convenience, : is a slicing operator to extracts all elements from a dimension. For example, h i1 = H :i1 represents the vector representation of the i-th timestep of the visual sequence. Here we denote the last index 1 for visual and 2 for textual modality. Each entry C ij (?i, j ? [1, T ]) is then calculated by:
where w c ? R 2d?1 and w h ? R 4d?2d are parameters to learn. The temporal correlation matrix captures the temporal dependency of question, image and text sequence. To allow the model to capture the context between timesteps based on the question, we introduce temporal focal pooling to connect neighboring time hidden states if they are related to the question. For example, it can capture the relevance between the moment "dinner" and the moment later, "Went dancing", given the question "What did we do after the dinner on Ben's birthday?". Formally, given the time correlation matrix C and the context representation H, we introduce a temporal focal pooling function g to obtain the focal representation F ? R 2d?T ?2 . Each vector entry
where F :tk is the focal context representation at t-th timestep for visual (k = 1) or text (k = 2). 1 is the indicator function. c stands for the size of the temporal window). Comparison of our FVTA and classical VQA attention mechanism. FVTA considers both visual-text intra-sequence correlations and cross sequence interaction, and focuses on a few, small regions. In FVTA, the multi-modal feature representation in the sequence data is preserved without losing information.
that is end-to-end learned with other parameters. We constrain the model to focus on a few small temporal context windows of learnable window size 2c + 1.

Cross Sequence Interaction
In this section, we introduce the attention mechanism to capture the important correlation between visual and textual sequences. We apply attention over the focal context representation to summarize important information for answering the question. We obtain the attention weights based on a correlation tensor S between each word of the question and each timestep of the visual-text sequences. The attention at each timestep only considers the context and the question, and does not depend on the attention at previous timestep. The intuition of using such a memory-less attention mechanism is that it simplifies the attention and let the model focus on learning the correlation between context and question. Such mechanism has been proven useful in text question answering. We computes a kernel tensor, S ? R M ?T ?2 , between the input question and the focal context representation F, where each entry in the kernel s mtk models the correlation between the m-th word in question and at t-th timestep over the modal k (images or text words). Let v tk denote the focal context representation F :tk at t-th timestep for visual or text. Each entry s mtk in S is calculated by:
where ? is a function to compute the correlation between question and context, w s ? R 4d?1 is the learned weights and b sis the bias term. sis the mapping defined in. As explained for Eq. (4), we use such similarity representations since they capture both the cosine similarity and Euclidean distance information. We obtain the visual-text sequence attention matrix A ? R T ?2 by A = sof tmax(max M i=1 (S i:: )) and the visual-text attention vector B ? R 2 by B = sof tmax(max T i=1 max M j=1 (S ji: )), where the softmax operation is applied to the first dimension. The maximum function maxi is used reduce the first dimension of the high-dimensional tensor. Then the attended context vector is given by:
The visual-text attention is computed based on the correlation between question and the focal context attention, which aligns with our observation that questions often provide constrains of a limited time window for the answers. Similarly, we compute the question attention D ? R M by D = sof tmax(max T i=1 max 2 j=1 (S :ij )) and the summarized question vector is given by:
Algorithm 1 summarizes the steps to compute the proposed FVTA attention. To obtain a final context representation, we first summarize the focal context representation separately for visual sequence and text sequence, emphasizing the most important information using the intra-sequence attention. Then, we obtain the final representation by summing the sequence vector representation based on the intersequence importance. illustrates the difference between FVT attention tensor and one-dimensional soft attention vector. Both mechanisms compute the attention but FVTA considers both visual-text intra-sequence correlations and cross sequence interaction. is a recently proposed visual-text question answering dataset. The dataset consists of 20,860 questions about 13,591 personal photos belonging to 101 real Flickr users. These personal photos capture a variety of key moments of their lives such as a trip to Japan, wedding ceremonies, family parties, etc. Each album and photo come with comprehensive visual-text information, including a timestamp, GPS, a photo title, an album title and description. The metadata is incomplete and GPS, the photo title, the album title and description may not present in every photo.
MemexQA provides 4 answer choices and only one correct answer for each question. The dataset also provides more than one ground truth grounding images for each question. There are five types of questions corresponding to the frequent search terms discovered in the Flickr search logs. The input visual-text sequence length varies for questions. Some questions are about images taken on a certain date e.g. "what did we do after 2006 Halloween party?"; others are about all images e.g. "what was the last time we drove to a bar?". Baseline Methods A large proportion of the existing solutions is to project image or videos into an embedding space, and train a classification model using these embeddings. We implement the following methods as baselines: Logistic Regression predicts the answer with concatenated image, question and metadata features as reported in. Embedding + LSTM utilizes word embeddings and character embeddings, along with the same visual embeddings used in FVTA. Embeddings are encoded by LSTM and averaged to get the final context representation. Embedding + LSTM + Concat concatenates the last LSTM output from different modalities to produce the final output. On the other hand, we compare the proposed model to a rich collection of VQA attention models: Classic Soft Attention uses classic one dimensional question-to-context attention to summarize context for question answering. A correlation matrix between each question word and context is used to compute the attention as in. DMN+ is the improved dynamic memory networks, which is one of the representative architectures that achieve good performance on the VQA Task. We implement the DMN+ network with each sentence and each photo representation used in our proposed network as supporting facts input. Multimodal Compact Bilinear Pooling is the state-of-the-art method on VQA  the single-modal attention flow model over all concatenated context representations with embeddings as in FVTA network. TGIF Temporal Attention is a recently proposed spatial-temporal reasoning network on sequential animated image QA. Since other baseline methods do not use spatial attention, we compare the TGIF network with temporal attention only. TGIF temporal attention uses a simple MLP to compute the attention and only the last hidden state of the question is considered. We compute the attention following and use the same output layer in our method.
Implementation Details In MemexQA dataset, each question is asked to a sequence of photos organized in albums. A photo might have 5 types of textual metadata, including the album title, album descriptions, GPS Locations, timestamp and a title. We use N to denote the maximum number of albums, K for the maximum number of photos in an album and V for the maximum words. For album-level textual sequences like album titles and descriptions, the K dimension only has one item and others are zero-padded. We also use zeros to pad those positions with no word/image. We encode GPS locations using words. The photos and their corresponding metadata form the visual-text sequences. All questions, textual context and answers are tokenized using the Stanford word tokenizer. We use pre-trained GloVe word embeddings, which is fixed during training. For image/video embedding, we extract fixed-size features using the pre-trained CNN model, Inception-ResNet, by concatenating the pool5 layer and classification layer's output before softmax. We then use a linear transformation to compress the image feature into 100 dimensional. Then a bi-directional LSTM is used for each modality to obtain contextual representations. Given a hidden state size of d, which is set to 50, we concatenate the output of both directions of the LSTM and get a question matrix Q ? R 2d?M and context tensor H ? R 2d?V ?K?N ?6 for all media documents. We reshape the context tensor into H ? R 2d?T ?6 .
To select the best hyperparmeters, we randomly select 20% of the official training set as the validation set. We use the AdaDelta optimizer and an initial learning rate of 0.5 to train for 200 epochs with a dropout rate of 0.3.. The quality comparison of the learned FVTA and classic attention. We compare the image of the highest activation in a leaned attention to the ground truth evidence photos which human used to answer the question. HIT@1 means the rate of the top attended images being found in the ground truth evidence photos. AP is computed on the photo ranked by their attention activation.

Comparison to the state-of-the-art
The MemexQA dataset provides ground truth evidence photos for every question. We can compare the correlation between the photos of the highest attention weights and the ground truth photos to correctly answer a question. An ideal VQA model should not only enjoy a high accuracy in answering a question but also can find images thatare highly correlated to the ground-truth evidence photos. lists the accuracy to examine whether a model puts focus on the correct photos. FVTA outperforms other attention models on finding the relevant photos for the question. The results show that the proposed attention can capture salient information for answering the question. For qualitative comparison, we select some representative questions and show both the answer and the retrieved top images based on the attention weights in. As shown in the first example, the system has to find the correct photo and visually identify the object to answer the question "what did the daughter eat while her dad was watching during the trip in June 2010?". FVTA attention puts a high weight on the correct photo of the girl eating acorn, which leads to correctly answering the question. Whereas for soft attention, the one-dimensional attention network outputs the wrong image and gets the wrong answer. This example shows the advantage of FVTA modeling the correlation at every time step, across visual-text sequences over the traditional dimensional attention. shows the performance of FVTA mechanism and its ablations on the MemexQA dataset. To evaluate the FVTA attention mechanism, we first replace our kernel tensor with simple cosine similarity function. Results show that standard cosine similarity is inferior to our similarity function. For ablating intra-sequence dependency, we use the representations from the last timestep of each context document. For ablating cross sequence interaction, we average all attended context representation from different modalities to get the final context vector. Both aspects of correlation of the FVTA attention tensor contribute towards the model's performance, while intra-sequence dependency shows more importance in this experiment. We compare the effectiveness of context-aware question attention by removing the question attention and use the last timestep of the LSTM output from the question as the question representation. It shows the question attention provides slight improvement. Finally, we train FVTA without photos to see the contribution of visual information. The result is quite good but it is perhaps not surprising due to the language bias in the questions and answers of the dataset, which is not uncommon in VQA dataset and in Visual7W. This also leaves significant rooms of improvement with visual information.

Ablation Study

Ablations
Accuracy 0.219 -MemN2N 0.342 -DEMN -0.300 Soft Attention 0.321 -MCB 0.362 -TGIF Temporal 0.371 -RWMN 0.387 0.363 FVTA 0.410 0.373 clips from the same movie and the corresponding subtitles. More details of the dataset can be viewed in. Implementation Details In the MovieQA dataset, each QA is given a set of N movie clips of the same movie, and each clip comes with subtitles. We implement FVTA network for MovieQA task with modality number of 2 (video & text). We set the maximum number of movie clips per question to N = 20, the maximum number of frames to consider to F = 10, the maximum number of subtitle sentences in a clip to K = 100 and the maximum words to V = 10.
Visual and text sequences are encoded the same way as in the MemexQA experiment. We use the AdaDelta optimizer with a minibatch of 16 and an initial learning rate of 0.5 to trained for 300 epochs. A dropout rate is set at 0., and Read-Write Memory Network (RWMN). shows the detailed comparison of MovieQA results using both videos and subtitles. FVTA model outperforms all baseline methods and achieves comparable performance to the state-of-the-art result 2 on the MovieQA test server. Notably, RWMN is a very recent work that uses memory net to cache sequential input, with a high capacity and flexibility due to the read and write networks. Our accuracy is 0.410 (vs 0.387 by RWMN) on the validation set and 0.373 (vs 0.363) on the test set. Benefiting from such modeling ability, FVTA consistently outperforms the classical attention models including soft attention, MCB and TGIF. The result demonstrates the consistent advantages of FVTA over other attention models in question-answering for multiple sequence data. illustrates the output of our FVTA model. FVTA cannot only predict the correct answer, but also identify the most relevant subtitle description as well as the movie  clip frames. As shown in, FVTA can provide finegrained level justifications such as the most informative movie frames or subtitle sentences, whereas most of existing methods cannot find fine-grained justifications from the attention computed at the movie clip level. We believe the results show the benefits and potentials of FVTA model.

Conclusions and future work
In this paper, we introduced a novel neural network model called Focal Visual-Text Attention network for answering questions over visual-text sequences. FVTA employed a hierarchical process to dynamically determine which modality and snippets to focus on in the sequential data to answer the question, and hence cannot only pre-dict the correct answers but also find the correct supporting justifications to help users verify the system's results. The comprehensive experimental results demonstrated that FVTA achieves comparable or even better than state-of-theart results on two major question answering benchmarks of sequential visual-text data. Our future work includes extending FVTA to large scale long visual-text sequences and removing the use of answer choice embeddings as the input.