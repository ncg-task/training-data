title
Exploiting Coarse-to-Fine Task Transfer for Aspect-level Sentiment Classification
abstract
Aspect-level sentiment classification (ASC) aims at identifying sentiment polarities towards aspects in a sentence, where the aspect can behave as a general Aspect Category (AC) or a specific Aspect Term (AT). However, due to the especially expensive and labor-intensive labeling, existing public corpora in AT-level are all relatively small. Meanwhile, most of the previous methods rely on complicated structures with given scarce data, which largely limits the efficacy of the neural models. In this paper, we exploit a new direction named coarse-to-fine task transfer, which aims to leverage knowledge learned from a rich-resource source domain of the coarse-grained AC task, which is more easily accessible, to improve the learning in a low-resource target domain of the fine-grained AT task. To resolve both the aspect granularity inconsistency and feature mismatch between domains, we propose a Multi-Granularity Alignment Network (MGAN). In MGAN, a novel Coarse2Fine attention guided by an auxiliary task can help the AC task modeling at the same finegrained level with the AT task. To alleviate the feature false alignment, a contrastive feature alignment method is adopted to align aspect-specific feature representations semantically. In addition, a large-scale multi-domain dataset for the AC task is provided. Empirically, extensive experiments demonstrate the effectiveness of the MGAN. Source domain (Restaurant-R1) Target domain (Laptop-L) resolution Aspect term: Polarity: Positive
Introduction
Aspect-level sentiment classification (ASC) aims to infer sentiment polarities over aspect categories (AC) or aspect terms (AT) distributed in sentences). An aspect category implicitly appears in the sentence, which describes a general category of the entities. For example, in the sentence "The salmon is tasty while the waiter is very rude", the user speaks positively and negatively towards two aspect categories "food" and "service", respectively. An aspect term characterizes a specific entity that explicitly occurs in the sentence. Considering the same sentence "The salmon is tasty while the waiter is very rude", the aspect terms are "salmon" and "waiter", and the user expresses positive and negative sentiments over them, respectively. In terms of the aspect granularity, the AC task is coarse-grained while the AT task is fine-grained.
To model aspect-oriented sentiment analysis, equipping Recurrent Neural Networks (RNNs) with the attention Copyright c 2019, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved. mechanism has become a mainstream approach, where RNNs aim to capture sequential patterns and the attention mechanism is to emphasize appropriate context features for encoding aspect-specific representations. Typically, attention-based RNN models can achieve good performance only when large corpora are available. However, AT-level datasets require the aspect terms to be comprehensively manually labeled or extracted by sequence labeling algorithms from the sentences, which is especially costly to obtain. Thus, existing public AT-level datasets are all relatively small, which limits the potential of neural models.
Nonetheless, we observe that plentiful AC-level corpora are more easily accessible. This is because that aspect categories are usually in a small set of general aspects that can be pre-defined. For example, commercial services such as review sites or social media can define a set of valuable aspect categories towards products or events in a particular domain (e.g., "food", "service", "speed", and "price" in the Restaurant domain). As a result, the mass collections of user preferences towards different aspect categories become practicable. Motivated by this observation, we propose a new problem named coarse-to-fine task transfer across both domain and granularity, with the aim of borrowing knowledge from an abundant source domain of the coarse-grained AC task to a small-scale target domain of the fine-grained AT task.
The challenges in fulfillment of this setting are two-fold: (1) task discrepancy: the two tasks concern with the aspects with different granularity. Source aspects are coarse-grained aspect categories, which lack a priori position information in the context. However, target aspects are fine-grained aspect terms, which have accurate position information. Thus, inconsistent granularity in aspects causes the discrepancy between tasks; (2) feature distribution discrepancy: generally the domains in the two tasks are different, which causes the distribution shift for both the aspects and its context between domains. For example, in the source Restaurant domain, tasty and delicious are used to express positive sentiment towards the aspect category "food", while lightweight and responsive often indicate positive sentiment towards the aspect term "mouse" in the target Laptop domain.
To resolve the challenges, we propose a novel framework named Multi-Granularity Alignment Network (MGAN) to simultaneously align aspect granularity and aspect-specific feature representations across domains. Specifically, the MGAN consists of two networks for learning aspect-specific representations for the two domains, respectively. First, to reduce the task discrepancy between domains, i.e., modeling the two tasks at the same fine-grained level, we propose a novel Coarse2Fine (C2F) attention module to help the source task automatically capture the corresponding aspect term in the context towards the given aspect category (e.g., "salmon" to the "food"). Without any additional labeling, the C2F attention module can learn the coarse-to-fine process by an auxiliary task. Actually, more specific aspect terms and their position information are most directly pertinent to the expression of sentiment. The C2F module makes up these missing information for the source task, which effectively reduces the aspect granularity gap between tasks and facilitates the subsequent feature alignment.
Second, considering that a sentence may contain multiple aspects with different sentiments, thus capturing incorrect sentiment features towards the aspect can mislead feature alignment. To prevent false alignment, we adopt the Contrastive Feature Alignment (CFA) (Motiian et al. 2017) to semantically align aspect-specific representations. The CFA considers both semantic alignment by maximally ensuring the equivalent distributions from different domains but the same class, and semantic separation by guaranteeing distributions from both different classes and domains to be as dissimilar as possible. Moreover, we build a large-scale multidomain dataset named YelpAspect with 100K samples for each domain to serve as highly beneficial source domains. Empirically, extensive experiments demonstrate that the proposed MGAN model can achieve superior performances on two AT-level datasets from SemEval'14 ABSA challenge and an ungrammatical AT-level twitter dataset.
Our contributions of this paper are four-fold: (1) to the best of our knowledge, a novel transfer setting cross both domain and granularity is first proposed for aspect-level sentiment analysis; (2) a new large-scale, multi-domain AC-level dataset is constructed; (3) the novel Coarse2Fine attention is proposed to effectively reduce the aspect granularity gap between tasks; (4) empirical studies verify the effectiveness of the proposed model on three AT-level benchmarks.

Related Work
Traditional supervised learning algorithms highly depend on extensive handcrafted features to solve aspect-level sentiment classification. These models fail to capture semantic relatedness between the aspect and its context. To overcome this issue, the attention mechanism, which has been successfully applied in many NLP tasks, can help the model explicitly capture intrinsic aspect-context association). However, most of these methods highly rely on data-driven RNNs or tailor-made structures to deal with complicated cases, which requires substantial AT-level data to train effective neural models. Different from them, the proposed model can highly benefit from useful knowledge learned from a related abundant domain of the AC-level task.
Existing domain adaptation tasks for sentiment analysis focus on traditional sentiment classification without considering the aspect. In terms of data scarcity and the value of task, transfer learning is more urgent for aspect-level sentiment analysis that characterizes users' different preferences. To the best of our knowledge, only a few studies have explored to transfer from a single aspect category to another in a same domain based on adversarial training. Different from that, we explore a motivated and challenging setting which aims to transfer cross both aspect granularity and domain.

Multi-Granularity Alignment Network
In this section, we introduce the proposed MGAN model. We first present the problem definition and notations, followed by an overview of the model. Then we detail the model with each components.

Problem Definition and Notations
Coarse-to-fine task transfer Suppose that we have sufficient AC-level labeled data
is available in a target domain D t . Note that each source aspect a s k belongs to a set of pre-defined aspect categories C while each target aspect at k is a sub-sequence of x t k , i.e., aspect term. The goal of this task is to learn an accurate classifier to predict the sentiment polarity of target testing data.

An Overview of the MGAN model
The goal of the MGAN aims to transfer from a rich-resource source domain of an AC task to facilitate a low-resource target domain of an AT task. The architecture of the proposed MGAN is shown in. Specifically, the MGAN consists of two networks for tackling the two aspect-level tasks respectively. To reduce the task discrepancy, the two networks contain different numbers of attention hops such that they can keep a consistent granularity and the symmetric information towards the aspect. In MGAN, two basic hop units are used similarly as common attention-based RNN models, where the Context2Aspect (C2A) attention aims to measure the importance of each aspect word and generate the aspect representation with the aid of each context word, and the Position-aware Sentiment (PaS) attention utilizes the obtained aspect representation and the position information of the aspect to capture relevant sentiment features in the context for encoding the aspect-specific representation.
Moreover, we build a Coarse2Fine (C2F) attention upon the C2A module to specifically model the source aspect before feeding to the PaS module. The C2F module uses the source aspect representation to attend corresponding aspect terms in the context and then the attended context features  is conversely predicted the category of the source aspect (pseudo-label). After obtaining aspect-specific representations, the knowledge transfer between the two tasks is via the contrastive feature alignment. In summary, the source network acts as a "teacher", which consists of three-level attention hops (C2A+C2F+PaS) for the AC task, while the target network is like a "student" that only uses two basic attention hops (C2A+PaS) for the AT task. In the following sections, we introduce each component of MGAN in details.

Bi-directional LSTM layer
Given a sentence-aspect pair (x, a) from the source or target domain, we assume that the sentence consists of n words, i.e., x = {w 1 , w 2 , ..., w n }, and the aspect contains m words, i.e., a = {w a 1 , w a 2 , ..., w am }. Then we map them into its embedding vectors e = {e i } n i=1 ? R n?dw and ea = {e a j } m j=1 ? R m?dw respectively. To capture phrase-level sentiment features in the context (e.g., "not satisfactory"), we employ a Bi-directional LSTM (Bi-LSTM) to preserve the contextual information for each word of the input sentence. The Bi-LSTM transforms the input e into the con-
hidden states of Bi-LSTM). For simplicity, we denote the operation of an LSTM unit one i as LSTM(e i ). Thus, the contextualized word representation hi ? R 2d h is obtained as
where ";" denotes the vector concatenation.

Context2Aspect (C2A) Attention
Not all aspect words contribute equally to the semantic of the aspect. For example, in the aspect term "techs at HP", the sentiment is usually expressed over the headword "techs" but seldom over modifiers like the brand name "HP". Thus, "techs" is more important than "at" and "HP". This also applies to the aspect category (e.g., "food seafood fish"). Thus, we propose the Context2Aspect (C2A) attention to measure the importance of the aspect words with regards to each context word. Formally, we calculate a pair-wise alignment matrix M ? R n?m between the context and the aspect, where the alignment score M (i, j) between the i-th context word and the j-th aspect word is obtained as
where W a and b a are learnable parameters. Then, we apply a row-wise softmax function to get probability distributions in each row. By defining ?(i) ? R m as the individual aspectlevel attention given the i-th context word, we average all the ?(i)'s to get the C2A attention as ? = 1 n n i=1 ?(i). The C2A attention further contributes the context-aware aspect representation by ha * = m j=1 ? j ea j , where * ? {s, t} denotes the source or target domain. We tackle the aspect representation ha * for the two tasks differently, where ha sis fed to the C2F module while ha t is directly fed to the PaS module.

Coarse2Fine (C2F) Attention
Aspect terms, which act as the true "opinion entity", are the most directly pertinent to the expression of sentiment. However, source task concerns with coarse-grained aspect categories that lack of detailed position information in the context. We wish to achieve task alignment such that the target task can leverage more useful knowledge learned from the source task at the same fine-grained level. It is observed that the number of source aspects is much smaller and many instances contain same aspect category, but the underlying entities can behave diversely in different contexts. For example, the aspect category "food seafood fish" can be instantiated as "salmon", "tuna", "taste" and etc. Based on this observation, we can capture more specific semantics of the source aspect and its position information conditioned on its context. Motivated by autoencoders ), we introduce an auxiliary pseudo-label prediction task for the source task. In this task, a source aspect a sis not only regarded as a sequence of aspect words, but also as a pseudo-label (category of the aspect) y c , where c ? C and C is a set of aspect categories. We utilize the obtained aspect representation ha s for a s to attend the context and then the induced attention scores aggregate the context information to conversely predict the pseudo category label of a s itself. If the context contains the aspect term correlated closely to the source aspect, then the attention mechanism can emphasize it for better prediction. We denote this mechanism as Coarse2Fine attention, which is calculated as:
where W f ? R du?(2d h +de) , bf ? R du and u f ? R du are the weights of the layer. We feed the attended representation v a to a softmax layer for the auxiliary task prediction, which is trained by minimizing the cross-entropy loss between the predicted pseudo-label? ck and its ground-truth y ck as:
However, there may not exist corresponding aspect term when the context implicitly expresses a sentiment toward the aspect category. To overcome this issue, similar to the gate mechanism in RNN variants (Jozefowicz, Zaremba, and Sutskever 2015), we adopt a fusion gate F to adaptively controls the passed proportions of ha sand v a towards a more specific source aspect representation r a s :
where W ? R de?(de+2d h ) and b ? R de are the weights of the gate, W ? R de?2d h performs dimension reduction, and denotes element-wise multiplication.

Position-aware Sentiment (PaS) Attention
Following an important observation found in) that a closer sentiment word is more likely to be the actual modifier of the aspect term (e.g., in "great food but the service is dreadful", "great" is more closer to "food" than "service"), we take the position information of the aspect term into consideration for designing the PaS attention. For the target domain, we adopt a proximity strategy to calculate the target position relevance between the i-th context word and aspect term as follows:
where m 0 is the index of the first aspect word, n and mare the length of the sentence and aspect, respectively. Unfortunately, in the source domain where aspect category is given, the exact position of the corresponding aspect term is not directly accessible. Instead, the C2F attention vector ? f ? Rn , indicating the probability of each context word being an aspect term, can help establish the position relevance. We first define a location matrix L ? R n?n to represent the proximity of each word in the sentence:
Then we calculate the source position relevance for i-th context word with the aid of C2F attention weights by
Obviously, the i-th context word closer to a possible aspect term with a large value in ? f will have a larger position relevance p s i . Finally, the PaS attention is calculated by a general form for both domains:
where p * i is the position relevance and r a * is the input aspect representation, with * ? {s, t} denoting the source or target domain (note that r at = ha t ). Then we pass the aspectspecific representation v o to a fully-connected layer and a softmax layer for sentiment classification. The sentiment classification tasks for both domain are trained by minimizing two cross-entropy losses L s sen and Lt sen , respectively.

Contrastive Feature Alignment
After obtaining aspect-specific representations of two domains at the same granularity, we would further bridge the distribution gap across domains. The prevalent unsupervised domain adaptation methods) require enormous unlabeled target data to achieve satisfactory performances, which is impractical in our problem where collecting unlabeled data needs laborintensive annotations of all aspect terms in the sentences. Therefore, inspired by (Motiian et al. 2017), we perform Contrastive Feature Alignment (CFA) by fully utilizing the limited target labeled data to semantically align representations across domains. Mathematically, we parameterize the two networks by g sand gt , and denote the probability distribution by P. Specifically, the CFA consisits of semantic alignment (SA) and semantic separation (SS). The SA aims to ensure identical distributions of feature representations P(g s (X s )) and P(g t (X t )) conditioned on different domains but the same class, while the SS further alleviates false alignment by guaranteeing P(g s (X s )) and P(g t (X t )) to be as dissimilar as possible conditioned on both different domains and classes. Considering that only a small amount of target labeled data is available, we revert the CFA characterizing distributions with enough data to pair-wise surrogates as:
where ?(?, ?) is a contrastive function that performs semantic alignment or separation in terms of supervised information from both domains. Formally, ?(?, ?) is defined as:
where Dis a parameter dictating the degree of separation and is set to 1 in our experiments.

Alternating Training
Combining the losses we introduced before together with a 2 regularization, we constitute the over all losses for the source and target networks as:
L tar = Lt sen + ?L cf a + ?L t reg ,
where ?, ? balance the effect of the CFA loss and the 2 regularization loss, respectively. The source network has one more auxiliary loss L aux compared with the target one to achieve task alignment. The whole training procedure consists of two stages: (1) To prevent early overfitting of the target domain, the source network S is individually trained on the source domain by optimizing L s sen + L aux + ?L s reg . Then, Sand the BiLSTM, C2A, and PaS modules of S are used to initialize the source and target networks of the MGAN, respectively. (2) We alternately optimize L src for the source network and L tar for the target network.

Experiments Datasets
Source: AC-level We build a large-scale, multi-domain dataset named YelpAspect as source domains, which is obtained similarly as the Yelp recommendation dataset (Bauman,. Specifically, YelpAspect contains three domains: Restaurant (R1), Beautyspa (B), and Hotel (H). The statistics of the YelpAspect dataset are summarized in. Yelp reviews are collected in US cities over six years. Aspect categories and sentiment labels are identified by the "industrial-strength" Opinion Parser (OP) system. To be consistent with the target domain datasets, YelpAspect is preprocessed in the sentence level by OP, while the dataset in (Bauman, is in the document level. Moreover, we manually double-check to correct wrong annotations produced by OP system and purposely select more negation, contrastive and question instances to make it more challenging. The dataset is available at https://github.com/ hsqmlzno1/MGAN.   . The Twitter dataset is collected by, containing ungrammatical twitter posts.

Experimental Setup
To evaluate our proposed method, we construct eight coarseto-fine transfer tasks: R1?L, H?L, B?L, H?R2, B?R2, R1?T, H?T, B?T, where we do not use the pair (R1, R2) as they come from the same domain. For each transfer pair D s ?D t , the training data from domain D sand randomly sampled 90% training data from domain D tare used for training, the rest 10% training data from D t is used for validation, and the testing data from D t is used for testing. Evaluation metrics are Accuracy and Macro-Average F1, where the latter is more suitable for imbalanced datasets.

Implementation Details
The word embeddings are initialized with 200-dimension GloVE vectors and fine-tuned during the training. d e , d h , d u are set to be 200, 150 and 100, respectively. The fc layer size is 300. The Adam (Kingma and Ba 2014) is used as the optimizer with the initial learning rate 10 ?4 . Gradients with the 2 norm larger than 40 are normalized to be 40. All weights in networks are randomly initialized from a uniform distribution U (?0.01, 0.01). The batch sizes are 64 and 32 for source and target domains, respectively. The control-off factors ?, ? are set to be 0.1 and 10 ?6 . To alleviate overfitting, we apply dropout on the word embeddings of the context with dropout rate 0.5. We also perform early stopping on the validation set during the training process. The hyperparameters are tuned on 10% randomly held-out training data of the target domain in R1?L task and are fixed to be used in all transfer pairs.

Baseline Methods
The baseline methods are divided into two groups: Non-Transfer To demonstrate the benefits from coarse-tofine task transfer, we compare with the following state-ofthe-art AT-level methods without transfer:   ? Target Network (TN): It is our proposed base model (BiLSTM+C2A+Pas) trained on D t for the target task.
For IAN, we report the results in the original paper and use the source codes of other methods for experiments.
Transfer To investigate the effectiveness of the CFA , we also compare the following transfer methods:
? Source-only (SO): It uses a source network trained on D s to initialize a target network and then tests it on D t .
? Fine-tuning (FT): It advances SO with further finetuning the target network on D t .
? M-DAN: It is a multi-adversarial version of Domain Adversarial Network (DAN)) based on multiple domain discriminators. All discriminators are built upon the PaS layers of the two networks, each of which aligns one class distribution between domains.
? M-MMD: Similar with M-DAN, M-MMD aligns different class distributions between domains based on multiple Maximum Mean Discrepancy (MMD)). For each MMD, following the), we use a linear combination of 19 RBF kernels with the width parameters ranging from 10 ?6 to 10 6 .
The original DAN and MMD are unsupervised domain adaptation methods. Thus, for fair comparison, we use the source code of DAN and MMD, and extend them to M-DAN and M-MMD that utilize target supervised information and have higher performances, respectively.

Result Analysis
Comparison with Non-Transfer Note that we are the first to explore transfer techniques and achieve the best performances in this task. Thus, it is necessary to show our improvements over current superior non-transfer methods. The classification results are shown in  TN that does not utilize the knowledge from the source task, can only compete against with the baselines. It could be more convincing that the MGAN can achieve superior performances even with a simple model for the target task. This also indicates that the efficacy of MGAN benefits from leveraging useful knowledge learned from the source task.
(2) MGAN consistently outperforms the MGAN w/o C2F, where C2F module of the source network is removed and the source position information is missed (we set all p s i to 1), by 1.41%, 1.03%, 1.09% for accuracy and 1.79%, 3.62% and 1.16% for Macro-F1 on average. This is because that the C2F can effectively reduce the aspect granularity gap between tasks such that more useful knowledge can be distilled to facilitate the target task. (3) Position information is crucial for aspect-level sentiment analysis. The MGAN w/o PI, which does not utilize the position information, performs very poorly.

Comparison with Transfer
To avoid the effect of aspect granularity gap, all these models keep the C2F module. The compared results are shown in. SO performs poorly due to no adaptation applied. The popular technique FT cannot achieve satisfactory results since fine-tuning may cause the oblivion of useful knowledge from the source task. The full model MGAN outperforms M-DAN and M-MMD by 1.80% and 1.33% for accuracy and 1.90% and 1.66% for Marco-F1 on average, respectively. We derive two possible    reasons: First, enormous target data is unavailable since it is hard to obtain, thus, it maybe insufficient to represent target distributions by limited target labeled data for the distribution alignment based methods; Second, M-DAN and M-MMD focus on the semantic alignment but ignore semantic separation. Remarkably, MGAN considers both of them in a point-wise surrogate, which altogether improves the performance of our method. Besides, MGAN outperforms its ablation MGAN w/o SS removing the semantic separation loss of the CFA by 0.81% for accuracy and 1.00% for Macro-F1 on average, which implies that the semantic separation plays an important role in alleviating false alignment.

Effect of C2F Attention Module
We now give some illustrated examples to show the effect of C2F for solving aspect granularity inconsistency, by comparing MGAN and MGAN w/o C2F. Some hard cases containing multiple sentiment-aspect paris in the R1?L task are shown in. In the source domain R1, both models first utilize the C2A to attend the informative part of the aspect category, e.g., "cheese", "seafood sea" and "cuisine", which are representatives for each aspect. Then, compared with MGAN w/o C2F, MGAN further uses C2F to capture more specific aspect terms from the context towards the aspect category, such as "shells" to food seafood sea, which helps the source task capture more fine-grained semantics of aspect category and detailed position information like the target task, such that the sentiment attention can be positionaware and identify more relevant sentiment features towards the aspect. For example, in the (a) and (c), the user expresses a positive sentiment over food food cheese but a negative attitude towards restaurant cuisine (cuisine means a style of cooking especially as a characteristic of a particular country or region). MGAN captures the regional words for the cooking style, i.e., "italian place" towards restaurant cuisine and the related n-gram sentiment feature "fake junk" instead of the "not the fake junk" for the "ricotta cheese", and finally makes a correct prediction, which helps distill more useful knowledge for subsequent feature alignment. While MGAN w/o C2F locates wrong sentiment contexts and fails in (c). As such, benefited from distilled knowledge from the source task, MGAN can better model the complicated relatedness between the context and aspect term for the target domain L, but MGAN w/o C2F performs poorly though it make true predictions in (d) and (e). Moreover, as shown in, we list some samples of captured associated aspect terms towards different aspect categories based on the highest C2F attention weight. These underlying aspect terms make the source task more correlated to the target task.

Conclusion and Future Work
In this paper, we explore a motivated direction for aspectlevel sentiment classification named coarse-to-fine task transfer and build a large-scale YelpAspect dataset as highly beneficial source benchmarks. A novel MGAN model is proposed to solve both aspect granularity inconsistency and domain feature mismatch problems, and achieves superior performances. Moreover, there are many other potential directions, like transferring between different aspect categories across domains, transferring to a AT-level task where the aspect terms are also not given and need to be firstly identified. We believe all these can help improve the ASC task and there will be more effective solutions coming in the near future.