title
Long Text Generation via Adversarial Training with Leaked Information
abstract
Automatically generating coherent and semantically meaningful text has many applications in machine translation , dialogue systems , image captioning , etc .
Recently , by combining with policy gradient , Generative Adversarial Nets ( GAN ) that use a discriminative model to guide the training of the generative model as a reinforcement learning policy has shown promising results in text generation .
However , the scalar guiding signal is only available after the entire text has been generated and lacks intermediate information about text structure during the generative process .
As such , it limits its success when the length of the generated text samples is long ( more than 20 words ) .
In this paper , we propose a new framework , called LeakGAN , to address the problem for long text generation .
We allow the discriminative net to leak its own high - level extracted features to the generative net to further help the guidance .
The generator incorporates such informative signals into all generation steps through an additional MANAGER module , which takes the extracted features of current generated words and outputs a latent vector to guide the WORKER module for next - word generation .
Our extensive experiments on synthetic data and various realworld tasks with Turing test demonstrate that LeakGAN is highly effective in long text generation and also improves the performance in short text generation scenarios .
More importantly , without any supervision , LeakGAN would be able to implicitly learn sentence structures only through the interaction between MANAGER and WORKER .
Introduction
The ability to generate coherent and semantically meaningful text plays a key role in many natural language processing applications such as machine translation , dialogue generation , and image captioning .
While most previous work focuses on task - specific applications in supervised settings , the generic unsupervised text generation , which aims to mimic the distribution over real text from a corpus , has recently drawn much attention ; * Correspondence to Weinan Zhang .
This work is financially supported by NSFC ( 61702327 ) and Shanghai Sailing Program ( 17YF1428200 ) .
Copyright c 2018 , Association for the Advancement of Artificial Intelligence ( www.aaai.org ) .
All rights reserved ..
A typical approach is to train a recurrent neural network ( RNN ) to maximize the log-likelihood of each ground - truth word given prior observed words , which , however , suffers from so - called exposure bias due to the discrepancy between training and inference stage : the model sequentially generates the next word based on previously generated words during inference but itself is trained to generate words given ground - truth words .
A scheduled sampling approach is proposed to addressed this problem , but is proved to be fundamentally inconsistent .
Generative Adversarial Nets ( GAN ) , which is firstly proposed for continous data ( image generation etc. ) , is then extended to discrete , sequential data to alleviate the above problem and has shown promising results ) .
Due to the discrete nature of text samples , text generation is modeled as a sequential decision making process , where the state is previously generated words , the action is the next word to be generated , and the generative net G is a stochastic policy that maps current state to a distribution over the action space .
After the whole text generation is done , the generated text samples are then fed to the discriminative net D , a classifier that is trained to distinguish real and generated text samples , to get reward signals for updating G.
Since then , various methods have been proposed in text generation via GAN .
Nonetheless , the reported results are limited to the cases that the generated text samples are short ( say , fewer than 20 words ) while more challenging long text generation is hardly studied , which is necessary for practical tasks such as auto-generation of news articles or product descriptions .
A main drawback of existing methods to long text generation is that the binary guiding signal from Dis sparse as it is only available when the whole text sample is generated .
Also , the scalar guiding signal for a whole text is non-informative as it does not necessarily preserve the picture about the intermediate syntactic structure and semantics of the text that is being generated for G to sufficiently learn .
On one hand , to make the guiding signals more informative , discriminator D could potentially provide more guidance beside the final reward value , since Dis a trained model , e.g. a convolutional neural network ( CNN ) , rather than an unknown black box .
With that idea , proposed to train generator G via forcing learned feature representations of real and generated text by D to be matched , instead of directly training G to maximize the reward from D. Such a method can be effective in short text generation , but the guiding signals are still absent until the end of the text ) .
On the other hand , to alleviate the sparsity problem of the guiding signal , the idea of hierarchy naturally arises in text generation , since the real text samples are generated following some kinds of hierarchy such as the semantic structure and the part - of - speech .
By decomposing the whole generation task into various sub - tasks according to the hierarchical structure , it becomes much easier for the model to learn .
Early efforts have been made to incorporate the hierarchy idea in text generation ) but all use a predefined sub - task set from domain knowledge , which makes them unable to adapt to arbitrary sequence generation tasks .
In this paper , we propose a new algorithmic framework called Leak GAN to address both the non-informativeness and the sparsity issues .
LeakGAN is a new way of providing richer information from the discriminator to the generator by borrowing the recent advances in hierarchical reinforcement learning .
As illustrated in , we specifically introduce a hierarchical generator G , which consists of a high - level MANAGER module and a low - level WORKER module .
The MANAGER is along shortterm memory network ( LSTM ) and serves as a mediator .
In each step , it receives generator D 's high - level feature representation , e.g. , the feature map of the CNN , and uses it to form the guiding goal for the WORKER module in that timestep .
As the information from D is internally - maintained and in an adversarial game it is not supposed to provide G with such information .
We thus call it a leakage of information from D.
Next , given the goal embedding produced by the MAN - AGER , the WORKER first encodes current generated words with another LSTM , then combines the output of the LSTM and the goal embedding to take a final action at current state .
As such , the guiding signals from D are not only available to G at the end in terms of the scalar reward signals , but also available in terms of a goal embedding vector during the generation process to guide G how to get improved .
We conduct extensive experiments based on synthetic and real data .
For synthetic data , Leak GAN obtains much lower negative log - likelihood than previous models with sequence length set to 20 and 40 .
For real data , we use the text in EMNLP 2017 WMT News , COCO Image Caption and Chinese Poems as the long , mid-length and short text corpus , respectively .
In all those cases , LeakGAN shows significant improvements compared to previous models in terms of BLEU statistics and human Turing test .
We further provide a deep investigation on the interaction between MAN - AGER and WORKER , which indicates Leak GAN implicitly learns sentence structures , such as punctuation , clause structure and long suffix without any supervision . :
An overview of our Leak GAN text generation framework .
While the generator is responsible to generate the next word , the discriminator adversarially judges the generated sentence once it is complete .
The chief novelty lies in that , unlike conventional adversarial training , during the process , the discriminator reveals its internal state ( feature ft ) in order to guide the generator more informatively and frequently .
( See Methodology Section for more details . )
Related Work
Generating text that mimics human 's expression has been studied for poem generation , image captioning , dialogue system ) machine translation . proposed a recurent neural network ( RNN ) based generative model to use the human - generated text where at each step the model tries to predict the next word given previous real word sequence and is trained in a supervised fashion .
A common difficulty of all supervised generative models is that it is hard to design an appropriate , differentiable , lowbias metric to evaluate the output of the generator , which inspires the adversarial training mechanisms .
proposed generative adversarial nets ( GANs ) to generate continuous data like images .
GAN introduces a minimax game between a generative model and a discriminative model , where the discriminator can be viewed as the dynamically - updated evaluation metric to guide the tuning of the generated data .
To apply GANs to text generation , proposed SeqGAN that models the text generation as a sequential decision making process and trains the generative model with policy gradient methods . MaliGAN ) modifies the orginal GAN objective and proposes a set of training techniques to reduce the potential variance .
To deal with the gradient vanishing problem of GAN , Rank GAN proposes an alternative solution to this problem by replacing the original binary classifier discriminator with a ranking model by taking a softmax over the expected cosine distances from the generated sequences to the real data .
Another problem for the adversarial sequence generation models is that the binary feedback from the discriminator is not sufficiently informative , which requires a huge number of training and generated samples to improve the generator and could result in mode collapse problems .
Feature Matching ) provides a mechanism that matches the latent feature distributions of real and generated sequences via a kernelized discepancy metric to alleviate the weak guidance and mode collapse problems .
However , such enhancement only happens when the whole text sample is generated and thus the guiding signal is still sparse during the training .
Reinforcement learning ( RL ) on the other hand also faces a similar difficulty when reward signals are sparse .
Hierarchical RL is one of the promising techniques for handling the sparse reward issue .
A typical approach in hierarchical RL is to manually identify the hierarchical structure for the agent by defining several low - level sub - tasks and learning micropolicies for each sub - task while learning a macro-policy for choosing which sub - task to solve .
Such methods can be very effective when the hierarchical structure is known a priori using domain knowledge in a given specific task , but fail to flexibly adapt to other tasks .
Recently , proposed an end - to - end framework for hierarchical RL where the sub -tasks are not identified manually but implicitly learned by a MANAGER module which takes current state as input and output a goal embedding vector to guide the low - level WORKER module .
In this work , we model the text generation procedure via adversarial training and policy gradient .
To address the sparse reward issue in long text generation , we follow ) and propose a hierarchy design , i.e. MANAGER and WORKER , for the generator .
As the reward function in our case is a discriminative model rather than a black box in , the high - level feature extracted by the discriminator given the current generated word sequence is sent to the MANAGER module .
As such , the MANAGER module can be also viewed as a spy that leaks information from the discriminator to better guide the generator .
To our knowledge , this is the first work that considers the information leaking in GAN framework for better training generators and combines hierarchical RL to address long text generation problems .
Methodology
We formalize the text generation problem as a sequential decision making process .
Specifically , at each timestep t , the agent takes the previously generated words as its current state , denoted ass t = ( x 1 , . . . , x i , . . . , x t ) , where xi represents a word token in the given vocabulary V .
A ?-parameterized generative net G ? , which corresponds to a stochastic policy , maps st to a distribution over the whole vocabulary , i.e. G ? ( |s t ) , from which the action x t + 1 , i.e. the next word to select is sampled .
We also train a ?-parameterized discriminative model D ?
that provides a scalar guiding signal D ? ( s T ) for G ? to adjust it s parameters when the whole sentence s T has been generated .
As we discussed previously , although the above adversarial training is principled , the scalar guiding signal becomes relatively less informative when the sentence length T goes larger .
To address this , the proposed LeakGAN framework allows discriminator D ? to provide additional information , denoted as features ft , of the current sentence st ( it is internally used for D ?
itself for discrimination ) to generator G ? ( |s t ) .
In LeakGAN , a hierarchical RL architecture is used as a promising mechanism to effectively incorporate such leaked information ft into the generation procedure of G ?
( also see ) .
Leaked Features from D as Guiding Signals
Different from typical model - free RL settings where the reward function is a black box , our adversarial text generation uses D ?
as a learned reward function .
Typically , D ? is a neural network and can be decomposed into a feature extractor F ( ; ? f ) and a final sigmoid classification layer with weight vector ? l .
Mathematically , given input s , we have
is the feature vector of sin the last layer of D ? , which is to be leaked to generator G ? .
As is shown in Eq. ( 1 ) , for a given D ? , the reward value for each state s mainly depends on the extracted features f .
As such , the objective of getting a higher reward from D ?
is equivalent to finding a higher reward region in this extracted feature ; thus F ( s ; ? f ) outputs the CNN feature map vector as f after its convolution - pooling - activation layer .
Other neural network models such as LSTM ( Hochreiter and Schmidhuber 1997 ) can also be used to implement D ? .
Compared to the scalar signal D ? ( s ) , the feature vector f is a much more informative guiding signal for G ? , since it tells what the position of currently - generated words is in the extracted feature space .
A Hierarchical Structure of G
In each step t during the generation procedure , to utilize the leaked information ft from D ? , we follow hierarchical RL to have a hierarchical architecture of G ? .
Specifically , we introduce a MANAGER module , an LSTM that takes the extracted feature vector ft as its input at each step t and outputs a goal vector gt , which is then fed into the WORKER module to guide the generation of the next word in order to approach the higher reward region in F ( S ; ? f ) .
Next we will first describe the detailed generator model in LeakGAN and then show how the MANAGER and WORKER are trained with the guiding signals from D ? .
Generation Process .
The MANAGER and WORKER modules both start from an all - zero hidden state , denoted ash M 0 and h W 0 respectively .
At each step , the MANAGER receives the leaked feature vector ft from the discriminator D ? , which is further combined with current hidden state of the MANAGER to produce the goal vector gt a ?
where M ( ; ? m ) denotes the MANAGER module implemented by an LSTM with parameters ?
m and h
Mt is the recurrent hidden vector of the LSTM .
To incorporate goals produced by MANAGER , a linear transformation ?
with weight matrix W ?
is performed on a summation over recent c goals to produce a k-dimensional goal embedding vector wt as
Given the goal embedding vector wt , the WORKER module takes the current word x t as input and outputs a matrix O t , which is further combined with wt by matrix product to determine the final action space distribution undercurrent state
where W ( ; ? w ) denotes the WORKER module , i.e. an LSTM with h W t as its recurrent hidden vector , O t is a | V |k matrix that represents the current vector for all words , thus O t wt yields the calculated logits for all words , and ?
is the temperature parameter to control the generation entropy .
Training of G Notice that the above procedure is fully differentiable .
One can train G ?
in an end - to - end manner using a policy gradient algorithm such as REINFORCE .
In LeakGAN , we would hope the MANAGER module to capture some meaningful patterns .
Thus , we follow ) and train the MANAGER and WORKER modules separately , where the MANAGER is trained to predict advantageous directions in the discriminative feature space and the WORKER is intrinsically rewarded to follow such directions .
Similar to , the gradient of the MAN - AGER module is defined as
is the expected reward under the current policy which can be approximately estimated via Monte Carlo search .
d cos represents the cosine similarity between the change of feature representation after cstep transitions , i.e. f t +c ? ft , and the goal vector gt (? m ) 1 produced by MANAGER as in Eq .
( 2 ) .
Intuitively , the loss function is to force the goal vector to match the transition in the feature space while achieving high reward .
At the same time , the WORKER is trained to maximize the reward using the REINFORCE algorithm as is done in , We use gt ( ? m ) to explicitly show gt is parameterized by ?m .
which can be approximated by sampling the state s t?1 and the action x t taken by WORKER .
As the WORKER is encouraged to follow the directions produced by the MANAGER , following , the intrinsic reward for the WORKER is defined as
In practice , before the adversarial training , we need to pretrain G ? .
To be consistent , in the pre-train stage , we also use the separate training scheme , where the gradient of MAN - AGER is
wheref t = F (? t ) , ? t and ?
t+c are states of real text , and the state - action value Q F ( s t , gt ) in Eq. is set as 1 here since the data instances used in pre-training are all real sentences .
As such , the MANAGER is trained to mimic the transition of real text samples in the feature space .
While the WORKER is trained via maximum likelihood estimation ( MLE ) .
In the training process , the generator G ? and discriminator D ? are alternatively trained .
In the generator , the MAN - AGER M ( ; ? m ) and WORKER W ( ; ? w ) ( including ?
and softmax ) are alternatively trained while fixing the other .
The details of the training procedure are attached in the supplementary material 2 .
Training Techniques
Bootstrapped Rescaled Activation .
During the adversarial training of , severe gradient vanishing occurs when Dis much stronger than G , i.e. the reward is too small value to update the parameters and thus need be rescaled before being fed into G. Inspired by ranking idea from RankGAN ) , we propose a simple , time - efficient , rank - based method to rescale the rewards , named as bootstrapped rescaled activation .
For a mini-batch with B sequences , after the rollout of the generative model , the reward matrix is denoted as R BT .
For each timestep t , we rescale the t - th column vector R t via
where rank ( i ) denotes the i - th element 's high - to - low ranking in this column vector .
?
is a hyperparameter that controls the smoothness of the rescale activation . ? ( ) is an activation function that re-projects the equidifferent scoring based on ranking to a more effective distribution .
In our experiment , for example , the model adopts hyperparameter ? = 12.0 and the sigmoid function as ? ( ) .
There are two main advantages of the bootstrapped rescaled activation .
First , after this transformation , the expectation and variance of the reward in each mini -batch are constant .
In this case , the rescale activation serves as a value stabilizer that is helpful for algorithms thatare sensitive in numerical variance .
Second , as all ranking methods do , it prevents the gradient vanishing problem , which accelerates the model convergence .
Interleaved Training .
In traditional generative adversarial models , mode collapse is a common problem .
Here we propose a training scheme called interleaved training to alleviate such a problem .
As its name is , we adopt an interleaving of supervised training ( i.e. MLE ) and adversarial training ( i.e. GAN ) instead of full GAN after the pre-training .
For example , we perform one epoch of supervised learning for G after 15 epochs of adversarial training .
An explanation of why this scheme works is that blending these two trainings would help GAN get rid of some bad local minimums and alleviate mode collapse .
Another justification is that the inserted supervised learning performs an implicit regularization on the generative model to prevent it from going too faraway from the MLE solution .
Temperature Control .
The Boltzmann temperature ?
in Eq. is a factor that could be used to balance the exploration and exploitation for reinforcement learning problems .
Here we select a higher temperature when we are training the model and a lower temperature when we adopt the model to generate samples .
Experiment
The experiment consists of three parts : synthetic data experiments , experiments in real - world scenarios and some explanation study .
The repeatable experiment code is published for further research 3 .
Training Settings
Synthetic Oracle .
For the synthetic data experiments , simlar to ( Yu et al. 2017 ) , we first initialize the parameters of an LSTM following the normal distribution N ( 0 , 1 ) as the oracle describing the real data distribution G oracle ( x t |x 1 , . . . , x t?1 ) .
We use it to generate 10,000 sequences of length 20 and 40 respectively as the training set S for the generative models .
GAN Setting .
For the discriminator , we choose the CNN architecture as the feature extractor and the binary classifier .
Note that one could design specific structure for different tasks to refine the CNN performance .
For the synthetic data experiment , the CNN kernel size ranges from 1 to T .
The number of each kernel is between 100 and 200 .
In this case , the feature of text is a 1,720 dimensional vector .
Dropout with the keep rate 0.75 and L2 regularization are performed to avoid overfitting .
For the generator , we adopt LSTM as the architectures of MANAGER and WORKER to capture the sequence context information .
The MANAGER produces the 16 - dimensional goal embedding feature vector wt using the feature map extracted by CNN .
The goal duration time c is a hyperparameter set as 4 after some preliminary experiments .
variants , such as SeqGAN with bootstrapped rescaled activation , and include the real data to be referred as the performance upperbound .
Evaluation Metrics .
Negative log - likehood ( NLL ) is used for synthetic data experiment since there is the oracle data distribution available for evaluation .
For real - world data experiments , BLEU statistics ) and human rating scores in the Turing test are reported .
We further perform a t-test for the improvement of Leak GAN over the second highest performance and report the p-value .
Synthetic Data Experiments
We run the synthetic data experiment with the text - length set as 20 and 40 respectively .
The training curves are depicted in and the over all NLL performance is presented in Table 1 .
One could have two observations from the results .
( i ) In the pre-training stage , LeakGAN has already shown observable performance superiority compared to other models , which indicates that the proposed hierarchical architecture itself brings improvement over the previous ones .
( ii ) In the adversarial training stage , Leak GAN shows a better speed of convergence , and the local minimum it explores is significantly better than previous results .
The results demonstrate the effectiveness of the information leakage framework and the hierarchical RL architecture for generating both short and long texts .
Long Text Generation : EMNLP2017 WMT News
We choose the EMNLP2017 WMT
4 Dataset as the long text corpus .
Specifically , we pick the News section from the original dataset .
The news dataset consists of 646,459 words and 397,726 sentences .
We preprocess the data by eliminating the words with frequency lower than 4,050 as well as the sentence containing these low frequency words .
Besides , to focus on long sentences , we remove the sentences with length less than 20 .
After the preprocessing , the news dataset has 5,742 words and 397,726 sentences .
Then we randomly sample 200,000 sentences as the training set and another 10,000 sentences as the test set .
We use the BLEU - ( 2 to 5 ) scores as the evaluation metrics .
The results are provided in .
In all measured metrics , LeakGAN shows significant performance gain compared to baseline models .
The consistently higher BLEU scores indicate that the generated sentences of Leak GAN are of high quality in local features to mimic the real text .
Middle Text Generation : COCO Image Captions
Another real dataset we use is the COCO Image Captions Dataset , a dataset which contains groups of image - description pairs .
We take the image captions as the text to generate .
Note that the COCO Dataset is not along text dataset , in which most sentences are of about 10 words .
Thus we apply some preprocessing on the dataset .
The COCO Image Captions training dataset consists of 20,734 words and 417,126 sentences .
We remove the words with frequency lower than 10 as well as the sentence containing them .
After the preprocessing , the dataset includes 4,980 words .
We randomly sample 80,000 sentences for the training set , and another 5,000 for the test set .
The results BLEU scores are provided in .
The results of the BLEU scores on the COCO dataset indicate that Leak GAN performs significantly better than baseline models in mid-length text generation task .
Short Text Generation : Chinese Poems
To evaluate the performance of Leak GAN in short text generation , we pick the dataset of Chinese poems which is proposed by and most related work such as .
The dataset consists of 4 - line 5 - character poems .
Following the above work , we use the BLEU - 2 scores as the evaluating metrics .
The experimental results are provided in .
The results on Chinese Poems indicate that LeakGAN successfully handles the short text generation tasks .
Performance Robustness in Long Text Generation
Long text generation has always been difficult among all text generation problems .
The difficulty of the problem is due to many factors , such as LSTM - RNN 's failure to capture longterm dependency , discriminator 's failure to give those " good but tiny " sequences appropriate penalty .
To explicitly evaluate the superiority of Leak GAN in long text generation , here we use the relative performance gain of Leak GAN over and RankGAN .
The results over EMNLP2017 WMT
News data are shown in .
The curves clearly show that Leak GAN yields larger performance gain over the baselines when the generated sentences are longer .
This fact supports our claim that LeakGAN is a robust framework for long text .
Turing Test and Generated Samples
Since BLEU score is a metric focusing on the local text statistics , which may not be sufficient for evaluating text generation quality , we also conduct a Turing test based on questionnaires on the Internet .
In the questionnaire , each ( machine generated or real ) sentence gets + 1 score when it is regarded as are al one , and 0 score otherwise .
We conduct the test with text generated by the models trained on WMT News and COCO Image Captions .
The average score for each algorithm is calculated .
In practice , we sample 20 sentences from every method and invite 62 people to participate the test , where everyone should judge the quality of 30 sentences from the compared three methods and thus each sentence is judged by 31 people .
For the comparison fairness , the sentences used in the questionnaires are randomly sampled .
gives the results .
The performance on two datasets indicates that the generated sentences of Leak GAN are of higher global consistency and better readability than those of SeqGAN .
A few samples generated by LeakGAN are illustrated in .
More samples and their comparison with those from ( 1 ) A bathroom with tiled walls and a shower on it .
( 2 ) A young man is holding a bottle of wine in his hand .
( 2 ) A couple of kids in front of a bathroom that is in a bathroom .
EMNLP2017 WMT
( 1 ) The American Medical Association said that the militants had been arrested in connection with the murder of the same incident .
( 1 ) " I think you should really really leave for because we had n't been busy , where it goes to one , " he wrote .
( 2 ) This is the first time that the Fed has been able to launch a probe into the country ' s nuclear program .
( 2 ) What you have to stop , if we do that , as late , law enforcement and where schools use a list of aid , it can rise .
Model Explanation
Feature Trace .
To verify that LeakGAN successfully exploits of the leaked message , we visualize the feature vector f T extracted from the real data by discriminator .
Besides , we visualize the feature trace , i.e. the features ft of prefix st during the generation , for LeakGAN , SeqGAN and Rank GAN via a 2 - D principal component analysis ( PCA ) .
The visualized traces are plotted in and more cases are presented in the supplementary material .
As we can see , during the generation process , in LeakGAN , the feature vector gradually approaches the real data feature vector region .
However , previous models , i.e. SeqGAN and RankGAN , fail to match the features even when the generation is completed .
This indicates that the proposed Leak - GAN does finish its design purpose of exploiting the leaked information from D ? to better match the feature vector distributions of real data .
Behaviors of Worker and Manager .
To give more details of how WORKER and MANAGER interact with each other and make use of the leaked information in the generative model , we visualize the interaction vector of the WORKER and MANAGER , i.e. , the dimension - wise product of their output ( O t wt as in Eq. ) .
Note that to simplify the explanation , here we reduce the signal dimension from 16 to 8 . presents an example sentence and more cases are provided in the supplementary material .
From , we find some intuitive interpretations of the implicit rules learned by the interaction of WORKER and MANAGER .
( i ) The 5th dimension stands for current token 's divergence from an entity token .
If the 5th value is high , the token would most possibly be a structural token , such as a modal verb , an article or a preposition .
( ii ) The 6th dimension suggests how long the suffix from current step will be .
If a peak occurs in the curve , there must be some token that triggers along suffix .
A frequently occurring example is the formal subject .
( iii ) Although hard to observe , we do find connections of the 7th dimension and the substructure of a sentence .
For example , when the start or the end of a subsentence occurs , there is an observable fluctuation in the 7th dimension .
This indicates that the token is most likely to be a punctuation or a conjuction .
Conclusion and Future work
In this paper , we proposed a new algorithmic framework called Leak GAN for generating long text via adversarial training .
By leaking the feature extracted by the discriminator as the step - by - step guiding signal to guide the generator better generating long text , LeakGAN addresses the non-informativeness and sparsity problems of the scalar reward signal in previous GAN solutions .
In the extensive experiments with synthetic data and real world data including long , mid-length and short text , LeakGAN achieved significant performance improvement over previous solutions , on both BLEU scores and human ratings .
Moreover , the analysis of the results shows that Leak GAN yields larger performance gain when the longer sentences are generated .
Finally , we also visualize and explain the efficacy of the guiding signals that LeakGAN learns without any supervision .
For future work , we plan to apply LeakGAN in more natural language process applications like dialogue systems and image captioning by providing more task - specific guiding information .
Also , enhancing the capacity of the discriminator to check the global consistency of the whole sentence is a promising direction .
WORKER of Generator
Pseudo Code
Algorithm 1 Adversarial Training with Leaked Information
Require : Hierachical policy G ? m ,?w ; discriminator D ? ; a sequence dataset S =
{ X1:T } 1 : Initialize G ? m ,?w , D ? with random weights ? m , ? w , ?.
2 : Pre-train D ? ( i.e. the feature extractor F ( ; ? f ) and the output layer sigmoid ( ? l , )) using S as positive samples and output from G ? m ,?w as negative samples .
3 : Pre-train G ?m ,? w using leaked information from D ?
4 : Perform the two parts of pre-training interleavingly until convergence .
5 : repeat 6 :
for g-steps do 7 :
Generate a sequence Y1:T = ( y1 , . . . , y T ) ? G ?
8:
fort in 1 : T do 9:
Store leaked information ft from D ?
10 :
Get
Experiment Settings
For synthetic data with length 20 , the learning rate for MANAGER and WORKER is set to 0.001 .
The goal dimension size k is set to 16 .
The embedding size of the LSTM - RNNs is set to 32 .
For the discriminative model , we set the hyperparameters of the CNN as For synthetic data with length 40 , the learning rate for MANAGER and WORKER is set to 0.0005 .
The goal dimension size k is set to 16 .
The embedding size of the LSTM - RNNs is set to 32 .
For the discriminative model , we set the hyperparameters of the CNN as
Discussions
The Necessity of the Hierarchical Architecture
The hierarchical architecture in Leak GAN serves as the mechanism of incorporating leaked information from D into G. However , in the body part , we have n't shown whether the explotation of hierachical architecture is a must .
Actually , what we have to point out is , the explotation of hierarchical reinforment learning is not a must , but a good choice in sequence decision scenarios .
We attempt to replace the hierarchical architecture by a fully connected layer .
However , the model is so numerically sensitive that we can not operate a stable training on it the original training settings .
A possible reason is that , since the feature space of CNN changes rapidly during the training procedure , linear transformation without any normalization may not be able to incorporate the information contained in the feature vector leaked from D .
Out of those who came last year , 69 percent were men , 18 percent were children and just 13 percent were women .
' Sometimes I think about leaving sex work , but because I am alone living costs are really expensive , ' she said .
' I was then stuck in the house for nearly two years only going out for short periods of time , ' she said .
He has not played for Tottenham 's first team since and it is now nearly two years since he completed a full Premier League match for the club .
This is apart of the population that is notorious for its lack of interest in actually showing up when the political process takes place .
I was paid far too little to pickup a dead off of the ground and put it back in the box .
Local media reported the group were not looking to hurt anybody , but they would not rule out violence if police tried to remove them .
The 55 to 43 vote was largely split down party lines and fell short of the 60 votes needed for the bill to advance .
We got to a bus station in the evening , but our connection did n't leave until the following morning .
It 's actually something that I had to add , because I was getting really frustrated losing to my hitting partner all the time .
Taiwan 's Defence Ministry said it was " aware of the information , " and declined further immediate comment , Reuters reported .
Her response to the international refugee crisis gave a million refugees hope that they maybe able to begin a new life .
I 'm racing against a guy who I lost a medal to - but am I ever going to get that medal back ?
LeakGAN
A man has been arrested at age 28 , a resident in Seattle , which was widely reported in 2007 .
I also think that ' s a good place for us , I ' m sure that this would be a good opportunity for me to get in touch .
What is the biggest problem for Clinton is that Donald Trump will be in the race and he ' s unlikely to be the nominee . "
We ' re going to do and we ' re going to put it out and get the ball , " he said . "
I would be afraid to blame the girls to go back but I was just dis appointed with the race , " he said .
"
I 'm not going to work together with a different role and we can win the game , " he added .
The couple 's lives are still missing and they have been killed in the city 's way to play against them , and because I came out there .
For the last three years , we 've got a lot of things that we need to do with this is based on the financial markets .
Do n't ask me , but I know , if I ' ll be able to be out of Hillary Clinton , I think it 's being made for the Congress . "
I am proud to be able to move forward because we do n't have to look at about , " he said .
That ' s why we ' re the most important people for the African American community and we ' ve made a good response .
But the move will be only in a fight against them , as well as likely to prevent an agreement to remain in the EU .
The American Medical Association said that the militants had been arrested in connection with the murder of the same incident .
The two - year - old girl has been charged with a suspect who was in the vehicle to the police station .
It is hard to buy on the Olympics , but we probably do n't see a lot of it .
"
I 'm not going to be very proud of the other countries , " he said .
He said the U. N. intelligence industry will not comment on the ground , which would be sensitive to the European Union .
I take my work in the days , but I would have to go down on Wednesday night .
SeqGAN
You only certainly might not rush it down for those circumstances where we are when they were the heads , and when she 's name . "
I think you should really really leave for because we had n't been busy , where it goes to one , " he wrote .
All the study knew was that they are , so they continue to provide support service and it does n't exist . '
It can say become up with nothing sales have reached the charge for the other any evidence that been virtually well below the $ 800 .
Three times before the start of the season is much early on 2015 we are in the third training every year .
That 's the idea of strength that decision they said , we have n't already lost four or seven , or Liverpool 's team .
That is not the time for the cost of changing the system and it was pushing for $ 20 million .
We had to take it a good day for a military , but nearly 6 , 000 ] and prepare for them through .
I actually did n't tell the background check the difference after my hour was to be recalled ... and it was great .
We are thinking about 40 , 000 and jobs in what is wrong in the coming and you know .
That is out how working you ca n't set out some pretty tight ... or what I 'm going through . "
I wanted to be made you decided to have a crisis that way up and get some sort of weapon , not much to give birth to for an American room .
She had been fined almost 200 , 000 with couple of asylum seekers in Syria and Iraq .
Perhaps not , in looking for , housing officials would help the frustration of Government , with an FBI shortly before 2020 .
Once we got to real show for the young man since I 'm sure she went to love it just , whether to be late later last year .
But , after a holiday period we might have to goon a total - out debate like that could have happened to us .
